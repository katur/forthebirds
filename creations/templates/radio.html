{% extends 'base.html' %}
{% load markdown_deux_tags %}


{% block body_id %}radio{% endblock %}


{% block page_title %}
<i>For the Birds</i> Radio Program
{% endblock %}


{% block content %}

<div id="all-programs">
  <ul id="year-list">
    {% for year in year_list %}
    <li>
      <a id="{{ year.year }}" class="year-button" href="#">
        {{ year.year }}</a>
    </li>
    {% endfor %}
  </ul>

  {% regroup programs by original_air_date.date|date:"Y" as years %}
  {% for year in years %}
  <ul id="{{ year.grouper }}" class="year-programs">
    {% for program in year.list %}
    <li class="program">
      <a class="program-info-button program-title-bar" href="#">
        <span class="title">
          {{ program.title }}
          ({{ program.original_air_date.date }})
        </span>
        <span class="description">
          {{ program.description|markdown }}
        </span>
      </a>

      <div class="program-info">
        {% if program.file %}
        <div class="audio">
          <audio controls preload="none">
            <source src="{{ MEDIA_URL }}{{ program.file }}" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
          <br>
          <a class="download-link"  href="{{ MEDIA_URL }}{{ program.file }}">
            Download .mp3</a>
        </div>
        {% endif %}

        {% if program.supplemental_content_url %}
        <div class="transcript">
          <a href="{{ program.supplemental_content_url }}">
            Transcript and photos</a>
        </div>
        {% endif %}

        <div>
          <a href="{{ program.get_absolute_url }}">
            Permalink</a>
        </div>

        {% include 'tags.html' with item=program %}
    </li>
    {% endfor %}
  </ul>
  {% endfor %}
</div>

{% endblock %}
